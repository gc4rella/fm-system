{
   "name":"iperf-NS",
   "vendor":"fokus",
   "version":"0.1",
   "vnfd":[
      {  
            "name":"iperf-server",
            "vendor":"fokus",
            "version":"0.2",
            "lifecycle_event":[  
                {  
                    "event":"INSTANTIATE",
                    "lifecycle_events":[  
                        "install.sh"
                    ]
                },{  
                    "event":"START",
                    "lifecycle_events":[
			          "install-srv.sh"
                    ]
                }
            ],
            "configurations":{  
                "configurationParameters":[  
                    {  
                        "confKey":"key",
                        "value":"value"
                    }
                ],
                "name":"server-configuration"
            },
            "virtual_link":[  
                {  
                    "name":"private"
                }
            ],
            "vdu":[  
                {  
                    "vm_image":[  
                        "openbaton/ems-final"
                    ],
                    "scale_in_out":2,
                    "vnfc":[  
                        {  
                            "connection_point":[  
                                {
                                    "floatingIp":"random",  
                                    "virtual_link_reference":"private"
                                }
                            ]
                        }
                    ],
                    "vimInstanceName":"vim-instance",
		    "high_availability":{
			   	"resiliencyLevel":"ACTIVE_STANDBY_STATELESS",
			        "redundancyScheme":"1:N"
		    },
		     "monitoring_parameter":[

                            "net.tcp.listen[5001]",


                            "system.cpu.load[all,avg1]",


			    "agent.ping",
				

			    "net.if.in[{#IFNAME},errors]",

			    "net.if.in[{#IFNAME},dropped]",

			    "net.if.out[{#IFNAME},errors]",

			    "net.if.out[{#IFNAME},dropped]",
			

			    "system.cpu.util[all,iowait,avg1]"
                    ],
		"fault_management_policy":[
                {
                    "name":"VNFC down",
                    "criteria":[
                        {
                            "parameter_ref":"agent.ping",
			    "function":"last()",
			    "vnfc_selector":"at_least_one",
                            "comparison_operator":"=",
                            "threshold":"0"
                        }
                    ],
                    "period":5,
                    "severity":"CRITICAL"
		},
		{
                    "name":"CPU load over 40%",
                    "criteria":[
                        {
                            "parameter_ref":"system.cpu.load[all,avg1]",
			    "function":"last()",
			    "vnfc_selector":"at_least_one",
                            "comparison_operator":">",
                            "threshold":"0.4"
                        }
                    ],
                    "severity":"MINOR"
		},{	
                  "name":"Iperf server down",
                  "criteria":[
                        {
                            "parameter_ref":"net.tcp.listen[5001]",
			    "function":"last()",
			    "vnfc_selector":"at_least_one",
                            "comparison_operator":"=",
                            "threshold":"0"
                        }
                    ],                    
                    "period":1,
                    "severity":"CRITICAL"
		},
		{
                    "name":"Unacceptable amount of error packets received in {#IFNAME}",
                    "criteria":[
                        {
                            "parameter_ref":"net.if.in[{#IFNAME},errors]",
			    "function":"abschange",
			    "vnfc_selector":"at_least_one",
                            "comparison_operator":">",
                            "threshold":"10"
                        }
                    ],
		    "period":10,
                    "severity":"MINOR"
		},{
                    "name":"CPU waiting time is too high for I/O operations",
                    "criteria":[
                        {
                            "parameter_ref":"system.cpu.util[all,iowait,avg1]",
			    "function":"last()",
			    "vnfc_selector":"at_least_one",
                            "comparison_operator":">",
                            "threshold":"5"
                        }
                    ],
		    "period":30,
                    "severity":"MINOR"
		}]
		}
		],		
            	"deployment_flavour":[  
                {  
                    "flavour_key":"m1.small"
                }
            ],
            "type":"server",
            "endpoint":"generic",
            "vnfPackageLocation":"https://gitlab.fokus.fraunhofer.de/openbaton/scripts-test-public.git"
        },
      {
         "vendor":"fokus",
         "version":"0.2",
         "name":"iperf-client",
         "type":"client",
         "endpoint":"generic",
         "configurations":{
            "name":"config_name",
            "configurationParameters":[

            ]
         },
         "vdu":[
            {
               "vm_image":[
                  "openbaton/ems-final"
               ],
               "vimInstanceName":"vim-instance",
               "scale_in_out":2,
               "vnfc":[
                  {
                     "connection_point":[
                        {
		           "floatingIp":"random", 
                           "virtual_link_reference":"private"
                        }
                     ]
                  }
               ]
            }
         ],
         "virtual_link":[
            {
               "name":"private"
            }
         ],
         "lifecycle_event":[
            {
               "event":"INSTANTIATE",
               "lifecycle_events":[
                  "install.sh"
               ]
            },
            {
               "event":"CONFIGURE",
               "lifecycle_events":[
                  "server_configure_only.sh"
               ]
            },
	    {
               "event":"START",
               "lifecycle_events":[
                  "iperf_client_start.sh"
               ]
            }
         ],
         "deployment_flavour":[
            {
               "flavour_key":"m1.small"
            }
         ],
         "vnfPackageLocation":"https://gitlab.fokus.fraunhofer.de/openbaton/scripts-test-public.git"
      }
   ],
   "vnffgd":[

   ],
   "vld":[
      {
         "name":"private"
      }
   ],
   "vnf_dependency":[
      {
         "source":{
            "name":"iperf-server"
         },
         "target":{
            "name":"iperf-client"
         },
         "parameters":[
            "private"
         ]
      }
   ]
}
